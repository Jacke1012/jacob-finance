FROM ubuntu:24.04

ENV DEBIAN_FRONTEND=noninteractive

# Install NGINX, Supervisor, and default PHP packages
RUN apt-get update && apt-get install -y --no-install-recommends \
      nginx supervisor \
      php-fpm php-cli php-mysql php-opcache php-curl php-xml php-mbstring php-zip

# Copy application code
COPY . /var/www/html
WORKDIR /var/www/html

# Copy configs
COPY nginx.conf /etc/nginx/nginx.conf
COPY supervisord.conf /etc/supervisor/conf.d/supervisord.conf


EXPOSE 80

COPY docker-entrypoint.sh /usr/local/bin/
RUN chmod 755 /usr/local/bin/docker-entrypoint.sh
ENTRYPOINT ["/usr/local/bin/docker-entrypoint.sh"]
CMD ["/usr/bin/supervisord","-n"]

